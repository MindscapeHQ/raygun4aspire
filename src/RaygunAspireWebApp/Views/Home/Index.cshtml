@{
    ViewData["Title"] = "Error list";
}

@model List<ErrorInstanceRow>

<div class="background--color-bg-surface-01 box-shadow--light-elevation-02 border-color--color-border-elevation">
  <table id="errorTable" class="width--full">
    <thead>
      <tr class="border-bottom-width--1 border-color--color-border-elevation height--40">
        <th class="padding-horizontal--12">Message</th>
        <th class="padding-horizontal--12 width--160 max-width--160">Seen</th>
      </tr>
    </thead>
    <tbody>
      @foreach (var file in Model)
      {
        <tr class="border-bottom-width--1 border-color--color-border-elevation height--40">
          <td class="padding-horizontal--12"><a href="/errorinstance/details/@file.Id">@file.Name</a></td>
          <td class="js-timestamp-cell padding-horizontal--12">@file.Timestamp</td>
        </tr>
      }
    </tbody>
  </table>
  <div class="padding--24"></div>
</div>

<script src="~/js/moment.min.js"></script>
<script>
  function formatDates() {
    var dateCells = document.querySelectorAll('#errorTable .js-timestamp-cell');
    dateCells.forEach(function (cell) {
      var rawDate = cell.textContent;
      var formattedDate = moment.utc(rawDate).fromNow();
      cell.textContent = formattedDate;
    });
  }

  document.addEventListener('DOMContentLoaded', formatDates);
</script>